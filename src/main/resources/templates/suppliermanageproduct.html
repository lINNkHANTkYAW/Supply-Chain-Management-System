<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">

   <!--=============== REMIXICONS ===============-->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.css">
   <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css}">
   <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css}">
   <link rel="stylesheet" th:href="@{https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css}">  

   <!--=============== CSS ===============-->
   <link rel="stylesheet" th:href="@{/css/suppliermanageproduct.css}">
   <link rel="stylesheet" th:href="@{/css/forall.css}">

   <title>Manage Product</title>
</head>
<body>
   <!--=============== HEADER ===============-->
   <header class="header" id="header">
      <div class="header__container">
         <div class="header__logo d-flex align-items-center">
            <!-- Message Box Dropdown -->
            <div class="dropdown mx-3">
               <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                 <i class="bi bi-envelope"></i> <!-- Message icon -->
               </a>
               <ul class="dropdown-menu">
                 <li><a class="dropdown-item" href="#">Message 1</a></li>
                 <li><a class="dropdown-item" href="#">Message 2</a></li>
                 <li><a class="dropdown-item" href="#">Message 3</a></li>
               </ul>
            </div>
   
            <!-- Notification Bell Dropdown -->
            <div class="dropdown mx-2">
               <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                 <i class="bi bi-bell"></i> <!-- Bell icon -->
               </a>
               <ul class="dropdown-menu">
                 <li><a class="dropdown-item" href="#">Notification 1</a></li>
                 <li><a class="dropdown-item" href="#">Notification 2</a></li>
                 <li><a class="dropdown-item" href="#">Notification 3</a></li>
               </ul>
            </div>
   
           
         </div>
         <button class="header__toggle" id="header-toggle">
            <i class="ri-menu-line"></i>
         </button>
      </div>
   </header>

   <!--=============== SIDEBAR ===============-->
   <nav class="sidebar" id="sidebar">
      <div class="sidebar__container">
         <div class="sidebar__user">
            <div class="sidebar__img" style="display: flex; justify-content: center; align-items: center; border-radius: 50%; overflow: hidden; background-color: #e0e0e0;">
                   <img id="profileImage" th:src="@{${supplier.user.profileImg != null} ? '/img/' + ${supplier.user.profileImg} : '/img/default-profile.jpg'}" alt="Profile Image">
                </div>
                <div class="sidebar__info">
                    <h3 th:text="${supplier.user.username}"></h3>
                    <span th:text="${supplier.user.email}"></span>
                </div>
         </div>

         <div class="sidebar__content">
            <div>
               <h3 class="sidebar__title">MANAGE</h3>
               <div class="sidebar__list">
                  <a th:href="@{/supplier-dashboard}" class="sidebar__link">
                     <i class="ri-pie-chart-2-fill"></i>
                     <span>Dashboard</span>
                  </a>
                  <a th:href="@{/supplier/manageproduct}" class="sidebar__link active-link">
                     <i class="bi bi-inboxes-fill"></i>
                     <span>Manage Product</span>
                  </a>
                  <a th:href="@{/suppliermanageinventory}" class="sidebar__link">
                     <i class="bi bi-boxes"></i>
                     <span>Manage Inventory</span>
                  </a>
                  <a th:href="@{/supplier/manageorder}" class="sidebar__link">
                     <i class="ri-arrow-up-down-line"></i>
                     <span>Manage Order</span>
                  </a>
                  <a th:href="@{/supplierorderhistory}" class="sidebar__link">
                     <i class="bi bi-journal-check"></i>
                     <span>Order History</span>
                  </a>
                  <a th:href="@{/supplieranalytics}" class="sidebar__link">
                     <i class="bi bi-bar-chart-line"></i>
                     <span>Analytics</span>
                  </a>
                  <a th:href="@{/suppliertransactionhistory}" class="sidebar__link">
                     <i class="bi bi-wallet"></i>
                     <span>Transaction History</span>
                  </a>
               </div>
            </div>
         </div>
         <div class="sidebar__actions">
            <button>
               <i class="ri-moon-clear-fill sidebar__link sidebar__theme" id="theme-button">
                  <span>Theme</span>
               </i>
            </button>
            <button class="sidebar__link" type="submit" id="logoutBtn">
        		<i class="ri-logout-box-r-fill"></i> Log Out
    		</button>
         </div>
      </div>
   </nav>

   <!--=============== MAIN ===============-->
   <main class="main container-fluid" id="main">
      <section id="products" class="card-data">
        <div style="display:flex; gap:60%;">
          <h2 style="color: black; padding: 20px;">Your Market Place</h2>
          <div class="add-item">
            <button id="add-item-btn">Register New Product</button>
          </div>
        </div>
        <div class="marketplace flex-box" id="marketplace">
          <!-- Products will be dynamically added here -->
        </div>
      </section>

      <div class="modal" id="add-item-modal">
          <div class="modal-content">
            <h3>New Product</h3>
            <form id="add-item-form">
              <input type="text" id="product-name" placeholder="Product Name" required>
              <textarea id="product-description" placeholder="Description" required></textarea>
              <input type="number" id="product-price" placeholder="Price" required>
              <input type="number" id="product-cost" placeholder="Cost" required>
              <input type="number" id="product-quantity" placeholder="Quantity" required>
              <select id="product-category" name="categoryId" required>
    		<option value="">Select Category</option>
    			<option th:each="category : ${categories}" 
            		th:value="${category.categoryId}" 
            		th:text="${category.categoryName}">
   				 </option>
			</select>

              <div class="image-upload" id="image-upload">
              <img th:if="${product != null and product.image != null}" 
     th:src="@{${product.image}}" 
     alt="Product Image" 
     width="150" 
     height="150">



    			<input type="file" id="product-image" name="image" accept="image/*" required>
			</div>
		<button type="submit">Save</button>

            </form>
          </div>
       </div>
   </main>

   <!--=============== MAIN JS ===============-->
   <script th:src="@{/js/forall.js}"></script>
   <script th:src="@{/js/addproducttest.js}"></script>
   <script th:src="@{https://code.jquery.com/jquery-3.5.1.slim.min.js}"></script>  
   <script th:src="@{https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js}"></script>
   <script th:src="@{https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js}"></script>
   <script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js}"></script>
   <script th:src="@{https://cdn.jsdelivr.net/npm/chart.js}"></script>
   <script>
   document.getElementById("logoutBtn").addEventListener("click", async function () {
	     try {
	         let response = await fetch("/api/logout", { method: "POST", credentials: "include" });
	         if (response.ok) {
	             window.location.href = "/"; // Redirect to home, which Spring Boot should handle
	         }
	     } catch (error) {
	         console.error("Logout failed:", error);
	     }
	 });
   </script>
</body>
</html>
